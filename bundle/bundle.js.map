{"version":3,"sources":["webpack:///webpack/bootstrap ac169a7a587b8c37814b","webpack:///./lib/update_instances.js","webpack:///./lib/main.js","webpack:///./lib/map.js","webpack:///./lib/map_style.js","webpack:///./lib/update_chart.js","webpack:///./lib/listener_installer.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;AC7DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAoB,EAAE;AACtB;AACA;AACA,QAAQ,6CAA6C;AACrD,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe,cAAc;AAC7B;AACA;;AAEA;AACA;AACA,mBAAmB,EAAE;AACrB;AACA,CAAC;AACD;;AAEA;;;;;;;;;;;;AC1DA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;ACpCD;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;;;AAGA;;;;;;;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;AC9SA;AACA;AACA;AACA;AACA,wBAAwB,6BAA6B,GAAG,kBAAkB;AAC1E;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,sCAAsC,QAAQ,kBAAkB;AAChE;;AAEA;;;;;;;;;AChFA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ac169a7a587b8c37814b","const updateInstances = (data) => {\n  const projection = d3.geoAlbersUsa().scale(1280).translate([960/2, 600/2]);\n\n  const map = d3.select(\"svg\");\n  const circles = map.selectAll(\".circle-instances\").remove().exit();\n  circles.data(data)\n    .enter().append(\"circle\")\n    .attr(\"class\", \"circle-instances\")\n    .on(\"mouseover\", handleMouseOver)\n    .on(\"mouseout\", handleMouseOut)\n    .attr(\"fill\", datum => {\n      if (datum.sources) return \"#f70000\";\n      else return \"#ccc\";\n    })\n    .attr(\"stroke\", \"black\")\n    .attr(\"cx\", datum => projection([datum.longitude, datum.latitude])[0])\n    .attr(\"cy\", datum => projection([datum.longitude, datum.latitude])[1])\n    .attr(\"r\", 0.5)\n    .transition().duration(750)\n    .attr(\"r\", datum => Math.sqrt(datum.total_victims));\n};\n\nconst handleMouseOver = (datum, i) => {\n  if (datum.sources) {\n    const currentCircle = d3.event.target;\n    const svg = d3.select(\"svg\");\n    const dialogue = svg.append(\"polygon\")\n    .attr(\"id\", `c${i}`)\n    .attr(\"points\", \"0,0 0,160 300,160 300,0 50,0 37.5,-15 25,0\")\n    .attr(\"transform\", `translate(\n      ${currentCircle.attributes.cx.nodeValue - 37.5},\n      ${parseFloat(currentCircle.attributes.cy.nodeValue) + 30}\n    )`)\n    .attr(\"fill\", \"#D8D8D8\")\n    .attr(\"opacity\", 0)\n    .transition()\n    .duration(500)\n    .attr(\"opacity\", 0.75);\n\n    const container = svg.append(\"foreignObject\")\n    .attr(\"width\", 300)\n    .attr(\"height\", 160)\n    .attr(\"x\", currentCircle.attributes.cx.nodeValue - 37.5)\n    .attr(\"y\", parseFloat(currentCircle.attributes.cy.nodeValue) + 30);\n\n    container.append(\"xhtml:div\")\n      .append(\"p\")\n      .html(`${datum.summary}`);\n  }\n};\n\nconst handleMouseOut = (datum, i) => {\n  if (datum.sources) {\n    d3.select(`#c${i}`).remove();\n    d3.select(\"foreignObject\").remove()\n;  }\n};\n\nexport default updateInstances;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/update_instances.js\n// module id = 0\n// module chunks = 0","import initMap from './map';\nimport updateInstances from './update_instances';\nimport listenerInstaller from './listener_installer';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n\n  let latLng = {};\n  let instances;\n  initMap();\n\n  d3.csv(\"https://raw.githubusercontent.com/liamzhang40/nothing_political/master/csv/merge.csv\").then(data => {\n    instances = data;\n    setTimeout(() => updateInstances(data), 1000);\n    listenerInstaller(instances, DOMElements);\n  });\n\n\n  document.getElementsByClassName('modal-screen')[0].addEventListener('click', e => {\n    document.getElementsByClassName('modal is-open')[0].classList.remove('is-open');\n  });\n\n  document.getElementsByClassName('close-modal')[0].addEventListener('click', e => {\n    document.getElementsByClassName('modal is-open')[0].classList.remove('is-open');\n  });\n\n  document.getElementsByClassName('open-modal')[0].addEventListener('click', e => {\n    document.getElementsByClassName('modal')[0].classList.add('is-open');\n  });\n\n  const DOMElements = {};\n\n  DOMElements.year_options = document.getElementById('year-options');\n  DOMElements.gender_options = document.getElementById('gender-options');\n  DOMElements.venue_options = document.getElementById('venue-options');\n  DOMElements.race_options = document.getElementById('race-options');\n  DOMElements.reset = document.getElementById('reset');\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/main.js\n// module id = 1\n// module chunks = 0","import mapStyle from './map_style';\nimport updateChart from './update_chart';\n\nlet gunSales;\nlet instances;\n\nconst initMap = () => {\n  const svg = d3.select(\"svg\");\n  const path = d3.geoPath(null);\n\n  d3.csv(\"https://raw.githubusercontent.com/liamzhang40/nothing_political/master/csv/nics_firearm_background_checks.csv\").then(data => {\n    gunSales = data;\n  });\n\n  d3.csv(\"https://raw.githubusercontent.com/liamzhang40/nothing_political/master/csv/merge.csv\").then(data => {\n    instances = data;\n  });\n\n  const mapPromise = d3.json(\"https://d3js.org/us-10m.v1.json\").then(us => {\n    const usData = topojson.feature(us, us.objects.states).features;\n    d3.tsv(\"https://gist.githubusercontent.com/mbostock/4090846/raw/07e73f3c2d21558489604a0bc434b3a5cf41a867/us-state-names.tsv\")\n    .then(stateNames => {\n      const nameHash = {};\n      stateNames.forEach(name => {\n        nameHash[name.id] = name.name;\n      });\n\n      svg.append(\"g\")\n        .attr(\"class\", \"states\")\n        .selectAll(\"path\")\n        .data(usData)\n        .enter().append(\"path\")\n        .attr(\"d\", path)\n        .attr(\"id\", datum => datum.id);\n\n      svg.append(\"path\")\n        .attr(\"class\", \"state-borders\")\n        .attr(\"d\", path(topojson.mesh(us, us.objects.states, (a, b) => a !== b )));\n\n      svg.append(\"g\")\n        .attr(\"class\", \"state-names\")\n        .selectAll(\"text\")\n        .data(usData)\n        .enter().append(\"text\")\n        .text(datum => {\n          if (datum.id[0] === \"0\") {\n            return nameHash[datum.id[1]];\n          } else {\n            return nameHash[datum.id];\n          }\n        })\n        .attr(\"x\", datum => path.centroid(datum)[0])\n        .attr(\"y\", datum => path.centroid(datum)[1])\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"fill\", \"#6f9ba5\")\n        .on(\"click\", handleClick);\n      });\n  });\n\n};\n\nconst handleClick = datum => {\n  const state = d3.event.target.textContent;\n  const selectedYear = document.getElementById(\"year-options\").value;\n  if (!selectedYear) {\n    window.alert(\"Please select a year!\");\n    return;\n  } else if (selectedYear === 'old') {\n    window.alert(\"No background check records before 2014!\");\n    return;\n  }\n\n  const selectedGunSales = gunSales.filter(sale => {\n    return sale.month.slice(0,4) === selectedYear && sale.state === state;\n  });\n\n  const selectedInstances = instances.filter(instance => {\n    return instance.date.slice(instance.date.length - 2) === selectedYear.slice(2) && instance.location === state;\n  });\n\n  updateChart(selectedGunSales, selectedInstances);\n};\n\n\nexport default initMap;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/map.js\n// module id = 2\n// module chunks = 0","const mapStyle = [\n  {\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#1d2c4d\"\n      }\n    ]\n  },\n  {\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#8ec3b9\"\n      }\n    ]\n  },\n  {\n    \"elementType\": \"labels.text.stroke\",\n    \"stylers\": [\n      {\n        \"color\": \"#1a3646\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"administrative.country\",\n    \"elementType\": \"geometry.stroke\",\n    \"stylers\": [\n      {\n        \"color\": \"#4b6878\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"administrative.land_parcel\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#64779e\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"administrative.neighborhood\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"administrative.province\",\n    \"elementType\": \"geometry.stroke\",\n    \"stylers\": [\n      {\n        \"color\": \"#4b6878\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"landscape.man_made\",\n    \"elementType\": \"geometry.stroke\",\n    \"stylers\": [\n      {\n        \"color\": \"#334e87\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"landscape.natural\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#023e58\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#283d6a\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi\",\n    \"elementType\": \"labels.text\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#6f9ba5\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi\",\n    \"elementType\": \"labels.text.stroke\",\n    \"stylers\": [\n      {\n        \"color\": \"#1d2c4d\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi.business\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi.park\",\n    \"elementType\": \"geometry.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#023e58\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"poi.park\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#3C7680\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#304a7d\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road\",\n    \"elementType\": \"labels\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road\",\n    \"elementType\": \"labels.icon\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#98a5be\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road\",\n    \"elementType\": \"labels.text.stroke\",\n    \"stylers\": [\n      {\n        \"color\": \"#1d2c4d\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road.highway\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#2c6675\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road.highway\",\n    \"elementType\": \"geometry.stroke\",\n    \"stylers\": [\n      {\n        \"color\": \"#255763\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road.highway\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#b0d5ce\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"road.highway\",\n    \"elementType\": \"labels.text.stroke\",\n    \"stylers\": [\n      {\n        \"color\": \"#023e58\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"transit\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"transit\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#98a5be\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"transit\",\n    \"elementType\": \"labels.text.stroke\",\n    \"stylers\": [\n      {\n        \"color\": \"#1d2c4d\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"transit.line\",\n    \"elementType\": \"geometry.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#283d6a\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"transit.station\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#3a4762\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"water\",\n    \"elementType\": \"geometry\",\n    \"stylers\": [\n      {\n        \"color\": \"#0e1626\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"water\",\n    \"elementType\": \"labels.text\",\n    \"stylers\": [\n      {\n        \"visibility\": \"off\"\n      }\n    ]\n  },\n  {\n    \"featureType\": \"water\",\n    \"elementType\": \"labels.text.fill\",\n    \"stylers\": [\n      {\n        \"color\": \"#4e6d70\"\n      }\n    ]\n  }\n];\n\nexport default mapStyle;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/map_style.js\n// module id = 3\n// module chunks = 0","const updateChart = (gunsales, instances) => {\n  const x = d3.scaleBand().rangeRound([0, 400]),\n        y = d3.scaleLinear().rangeRound([400, 0]),\n        barWidth = 400 / 2 / gunsales.length,\n        chartTitle = `${gunsales[0].month.slice(0,4)} ${gunsales[0].state} Firearm Background Checks`;\n        instances = parseInstances(instances);\n\n  gunsales.reverse();\n\n  x.domain(gunsales.map(datum => datum.month.slice(datum.month.length - 2)));\n  y.domain([0, d3.max(gunsales, (datum) => parseInt(datum.totals))]);\n\n  const svg = d3.select(\"svg\");\n  svg.selectAll(\".chart\").remove();\n  const chart = svg.append(\"g\")\n    .attr(\"class\", \"chart\")\n    .attr(\"transform\", \"translate(900, 280)\");\n\n  chart.append(\"text\")\n    .attr(\"class\", \"chart-title\")\n    .attr(\"x\", 40)\n    .attr(\"y\", -20)\n    .attr(\"fill\", \"#ccc\")\n    .attr(\"font-size\", \"15px\")\n    .text(chartTitle);\n\n\n  chart.append(\"g\")\n    .attr(\"class\", \"axis-x\")\n    .attr(\"transform\", \"translate(0, 400)\")\n    .call(d3.axisBottom(x))\n    .append(\"text\")\n    .text(\"month\")\n    .attr(\"transform\", \"translate(200, 40)\")\n    .attr(\"font-size\", \"12px\");\n\n  chart.append(\"g\")\n    .attr(\"class\", \"axis-y\")\n    .call(d3.axisLeft(y))\n    .append(\"text\")\n    .text(\"background check\")\n    .attr(\"transform\", \"rotate(-90)\")\n    .attr(\"x\", -160)\n    .attr(\"y\", -60)\n    .attr(\"font-size\", \"12px\");\n\n  chart.selectAll(\".bar\")\n    .data(gunsales)\n    .enter().append(\"rect\")\n    .attr(\"class\", \"bar\")\n    .attr(\"x\", datum => x(datum.month.slice(datum.month.length - 2)) + barWidth / 2)\n    .attr(\"y\", datum => y(parseInt(datum.totals)))\n    .transition()\n    .duration(500)\n    .attr(\"height\", datum => 400 - y(parseInt(datum.totals)))\n    .attr(\"width\", barWidth);\n\n  chart.selectAll(\".dot\")\n    .data(instances)\n    .enter().append(\"circle\")\n    .attr(\"cx\", datum => x(Object.keys(datum)[0]) + barWidth)\n    .attr(\"cy\", datum => 400 - parseInt(Object.values(datum)[0]) * 50)\n    .attr(\"fill\", \"#fff\")\n    .attr(\"r\", 0.5)\n    .transition()\n    .duration(750)\n    .attr(\"r\", Math.sqrt(barWidth));\n};\n\nconst parseInstances = instances => {\n  const res = {};\n  instances.forEach(instance => {\n    let month = instance.date.split('/')[0];\n    if (month.length === 1) month = \"0\" + month;\n    if (res[month]) res[month] += 1;\n    else res[month] = 1;\n  });\n  return Object.keys(res).map(key => {return {[key]: res[key]};});\n};\n\nexport default updateChart;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/update_chart.js\n// module id = 4\n// module chunks = 0","import updateInstances from './update_instances';\n\nlet year;\nlet gender;\nlet venue;\nlet race;\n\nconst listenerInstaller = (instances, DOMElements) => {\n  DOMElements.reset.addEventListener('click', () => {\n    document.querySelectorAll(\"select\").forEach(select => {\n      select.selectedIndex = 0;\n    });\n    updateInstances(instances);\n  });\n\n  DOMElements.year_options.addEventListener('change', e => {\n    year = e.currentTarget.value.slice(2);\n    const filteredInstances = filterInstances(instances);\n    updateInstances(filteredInstances);\n  });\n\n  DOMElements.venue_options.addEventListener('change', e => {\n    venue = e.currentTarget.value;\n    const filteredInstances = filterInstances(instances);\n    updateInstances(filteredInstances);\n  });\n\n  DOMElements.gender_options.addEventListener('change', e => {\n    gender = e.currentTarget.value;\n    const filteredInstances = filterInstances(instances);\n    updateInstances(filteredInstances);\n  });\n\n  DOMElements.race_options.addEventListener('change', e => {\n    race = e.currentTarget.value;\n    const filteredInstances = filterInstances(instances);\n    updateInstances(filteredInstances);\n  });\n};\n\nconst filterInstances = (instances) => {\n  const res = instances.filter(instance => {\n    let date = instance.date;\n    date = date.slice(date.length - 2);\n\n    return (!year || date === year || (parseInt(date) < 14 && year === \"d\")) &&\n      (!venue || instance.venue === venue) &&\n      (!gender || instance.gender === gender) &&\n      (!race || instance.race.toUpperCase() === race.toUpperCase());\n  });\n\n  return res;\n};\n\nexport default listenerInstaller;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/listener_installer.js\n// module id = 5\n// module chunks = 0"],"sourceRoot":""}